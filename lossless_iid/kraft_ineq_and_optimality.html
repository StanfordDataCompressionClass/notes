<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Kraft Inequality</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../././mdbook-admonish.css">
        <link rel="stylesheet" href=".././mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../contents.html">EE274: Data Compression, course notes</a></li><li class="chapter-item expanded "><a href="../lossless_iid/coverpage.html"><strong aria-hidden="true">1.</strong> Lossless data compression: basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../lossless_iid/intro.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../lossless_iid/prefix_free_codes.html"><strong aria-hidden="true">1.2.</strong> Prefix Free Codes</a></li><li class="chapter-item expanded "><a href="../lossless_iid/kraft_ineq_and_optimality.html" class="active"><strong aria-hidden="true">1.3.</strong> Kraft Inequality</a></li><li class="chapter-item expanded "><a href="../lossless_iid/entropy.html"><strong aria-hidden="true">1.4.</strong> Entropy and Neg-log likelihood thumb rule</a></li><li class="chapter-item expanded "><a href="../lossless_iid/huffman.html"><strong aria-hidden="true">1.5.</strong> Huffman coding</a></li><li class="chapter-item expanded "><a href="../lossless_iid/aep.html"><strong aria-hidden="true">1.6.</strong> Asymptotic Equipartition Property</a></li><li class="chapter-item expanded "><a href="../lossless_iid/arithmetic_coding.html"><strong aria-hidden="true">1.7.</strong> Arithmetic coding</a></li><li class="chapter-item expanded "><a href="../lossless_iid/ans.html"><strong aria-hidden="true">1.8.</strong> Asymmetric Numeral Systems</a></li><li class="chapter-item expanded "><a href="../lossless_iid/non_iid_sources.html"><strong aria-hidden="true">1.9.</strong> Non IID Sources and Entropy Rate</a></li><li class="chapter-item expanded "><a href="../lossless_iid/context_based_coding.html"><strong aria-hidden="true">1.10.</strong> Context-based coding</a></li><li class="chapter-item expanded "><a href="../lossless_iid/lz77.html"><strong aria-hidden="true">1.11.</strong> Universal Compression with LZ77</a></li><li class="chapter-item expanded "><a href="../lossless_iid/practical_tips.html"><strong aria-hidden="true">1.12.</strong> Practical Tips on Lossless Compression</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="../lossy/coverpage.html"><strong aria-hidden="true">2.</strong> Lossy data Compression</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../lossy/quant.html"><strong aria-hidden="true">2.1.</strong> Basics and Quantization</a></li><li class="chapter-item expanded "><a href="../lossy/rd.html"><strong aria-hidden="true">2.2.</strong> Rate-Distortion Theory</a></li><li class="chapter-item expanded "><a href="../lossy/transform_coding_theory.html"><strong aria-hidden="true">2.3.</strong> Transform Coding Theory</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="../resources.html"><strong aria-hidden="true">3.</strong> Resources</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="../homeworks/coverpage.html"><strong aria-hidden="true">4.</strong> Homeworks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../homeworks/HW1.html"><strong aria-hidden="true">4.1.</strong> HW1</a></li><li class="chapter-item expanded "><a href="../homeworks/HW1_sol.html"><strong aria-hidden="true">4.2.</strong> HW1 Solution</a></li><li class="chapter-item expanded "><a href="../homeworks/HW2.html"><strong aria-hidden="true">4.3.</strong> HW2</a></li><li class="chapter-item expanded "><a href="../homeworks/HW2_sol.html"><strong aria-hidden="true">4.4.</strong> HW2 Solution</a></li><li class="chapter-item expanded "><a href="../homeworks/HW3.html"><strong aria-hidden="true">4.5.</strong> HW3</a></li><li class="chapter-item expanded "><a href="../homeworks/HW3_sol.html"><strong aria-hidden="true">4.6.</strong> HW3 Solution</a></li><li class="chapter-item expanded "><a href="../homeworks/HW4.html"><strong aria-hidden="true">4.7.</strong> HW4</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="../projects.html"><strong aria-hidden="true">5.</strong> Project</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="../scl_tutorial/SCL_tutorial.html"><strong aria-hidden="true">6.</strong> SCL Tutorial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scl_tutorial/basics.html"><strong aria-hidden="true">6.1.</strong> SCL Basics</a></li><li class="chapter-item expanded "><a href="../scl_tutorial/exercise.html"><strong aria-hidden="true">6.2.</strong> SCL Exercise</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="../quiz_problems_2023.html"><strong aria-hidden="true">7.</strong> Quiz Problems (2023)</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="designing-prefix-free-codes"><a class="header" href="#designing-prefix-free-codes">Designing prefix-free codes</a></h1>
<p>As a recap, in the previous lecture we discussed how to design a prefix free code given the code lengths. We discussed
a simple procedure which constructs a <em>prefix-free tree</em> given the code-lengths.</p>
<p>We also saw a simple thumb rule $l_{optimal}(symbol) \approx \log_2 \frac{1}{p(symbol)}$ which tells us what the
code-lengths of the prefix-free code should be. In this lecture we are going to discuss two things:</p>
<ol>
<li>Justify that <em>correctness</em> of our prefix-free tree construction with lengths $ l(symbol) = \left\lceil \log_2
\frac{1}{p(symbol)} \right\rceil $</li>
<li>Look at a few more prefix-free code constructions</li>
</ol>
<h2 id="kraft-inequality--converse"><a class="header" href="#kraft-inequality--converse">Kraft Inequality &amp; converse</a></h2>
<p>With the goal of proving the <em>correctness</em> of the <em>prefx-free tree</em> construction, we will first look at a simple but
fundamental property of binary trees, called the <em>Kraft-Mcmillan Inequality</em> (or simply the <em>Kraft Inequality</em>)</p>
<div id="admonition-theorem-1-kraft-inequality" class="admonition admonish-example" role="note" aria-labelledby="admonition-theorem-1-kraft-inequality-title">
<div class="admonition-title">
<div id="admonition-theorem-1-kraft-inequality-title">
<p>Theorem-1: Kraft Inequality</p>
</div>
<a class="admonition-anchor-link" href="#admonition-theorem-1-kraft-inequality"></a>
</div>
<div>
<p>Consider a binary tree, where the leaf nodes $n_1,n_2,\ldots,n_k$ are at depths $l_1,l_2,\ldots,l_k$ from the root node respectively.</p>
<p>Then the node depths $l_1,l_2,\ldots,l_k$ satisfy the inequality:</p>
<p>$$ \sum_{i=1}^k 2^{-l_i} \leq 1$$</p>
</div>
</div>
<p>The inequality is quite elegant, and so is its proof. Any thoughts on how the proof might proceed? Here is a hint:</p>
<p><strong>Hint</strong>: Let $l_{max} = \max_{i=1}^k l_i$. Then, the Kraft inequality can be written as: $$ \sum_{i=1}^k 2^{l_
{max}-l_i} \leq 2^{l_{max}} $$ All we have done here is multiply both sides by $2^{l_{max}}$, but this simple
transformation will help make the inequality more interpretable! Can you see the proof now? Here is a proof sketch:</p>
<ul>
<li>Let's try to interpret the RHS, $2^{l_{max}}$ are the number of nodes of the binary tree at depth $l_{max}$.</li>
<li>The LHS also has a natural interpretation: Given a leaf node at depth $l_i$, one can imagine that it corresponds to
$2^{l_{max} - l_i}$ nodes at depth $l_{max}$.</li>
</ul>
<pre class="mermaid">graph TD
  *(Root) --&gt;|0| A:::endnode
  A -.-&gt; n6(.):::fake
  A -.-&gt; n7(.):::fake
  n6-.-&gt; n8(.):::fake
  n6-.-&gt; n9(.):::fake
  n7-.-&gt; m1(.):::fake
  n7-.-&gt; m2(.):::fake
  *(Root) --&gt;|1| n1(.)
  n1 --&gt;|10| B:::endnode
  B -.-&gt; m3(.):::fake
  B -.-&gt; m4(.):::fake
  n1 --&gt;|11| n2(.)
  n2 --&gt; |110| C:::endnode
  n2 --&gt; |111| D:::endnode
  classDef fake fill:#ddd;
</pre>
<p>For example in the tree example above, node $A$ has <code>4</code> nodes corresponding to it at <code>depth = 3</code>, while node $B$ has <code>2</code>
nodes.</p>
<ul>
<li>It is clear that the nodes at depth $l_{max}$ are distinct for each of the leaf nodes $n_i$ (Think why?). As the "total number of nodes at depth $l_{max}$", is larger than "the sum of nodes at depth $l_{max}$ corresponding to leaf nodes
$n_i$, we get the inequality</li>
</ul>
<p>$$ \sum_{i=1}^k 2^{l_{max}-l_{i}} \leq 2^{l_{max}} $$</p>
<ul>
<li>This completes the proof sketch for the Kraft Inequality:</li>
</ul>
<p>$$ \sum_{i=1}^k 2^{-l_i} \leq 1$$</p>
<p>Well, that was a short and simple proof! It is also clear that the equality is true, if and only if there is no leaf
node left unaccounted for.</p>
<p>We can use the Kraft inequality to now show the <em>correctness</em> of the prefix-free tree construction with code-lengths $l_{i}$, as we discussed in last lecture.</p>
<h2 id="prefix-tree-construction-correctness"><a class="header" href="#prefix-tree-construction-correctness">Prefix-tree construction <em>correctness</em></a></h2>
<p>To recap, our <em>prefix-free tree</em> construction proceeds as follows:</p>
<ol>
<li>
<p>We are given probability distribution $p_1, p_2, \ldots, p_k$ for symbols $s_1, s_2, \ldots,
s_k$. <a href="https://en.wikipedia.org/wiki/Without_loss_of_generality">WLOG</a> assume that: $$ p_1 \geq p_2 \geq ... \geq
p_k$$ Now, compute code-lengths $l_1, l_2, \ldots, l_k$ such that: $$ l_i = \left\lceil \log_2 \frac{1}{p_i}
\right\rceil $$ Thus, the lengths, $l_1, l_2, \ldots, l_k$ satisfy $$ l_1 \leq l_2 \leq ... \leq l_k$$</p>
</li>
<li>
<p>The <em>prefix-free tree</em> construction follows by starting with an empty binary tree, and then recursively adding a leaf
node at depth $l_i$ to the binary tree.</p>
</li>
</ol>
<p>We want to argue the <em>correctness</em> of the tree construction at each step, i.e. we want to show that when we are adding node $n_k$, there will always be a node available for us to do so.</p>
<p>Let's proceed towards showing this inductively.</p>
<ul>
<li>In the beginning, we just have the root node, so we can safely add the node $n_1$ with length $l_1$. To do so, we need
to create a binary tree with $2^{l_1}$ leaf nodes, and just assign one of the leaf nodes to node $n_1$</li>
<li>Now, let's assume that we already have a binary tree $\mathcal{T}<em>{r-1}$ with nodes $n_1, n_2, \ldots, n</em>{r-1}$ and
that we want to add node $n_r$. We want to argue that there will always be a leaf node available with depth $l_r$ in
the binary tree $\mathcal{T}_{r-1}$. Let's see how can we show that:</li>
<li>If we look at the code-lengths, i.e. the depths of the nodes $l_i$, we see that they follow the Kraft inequality $$
\begin{aligned}
\sum_{i=1}^k 2^{-l_i} &amp;= \sum_{i=1}^k 2^{-\left\lceil \log_2 \frac{1}{p_i} \right\rceil} \
&amp;= \sum_{i=1}^k 2^{\left\lfloor \log_2 p_i \right\rfloor} \
&amp;\leq \sum_{i=1}^k 2^{ \log_2 p_i} \
&amp;\leq \sum_{i=1}^k p_i \
&amp;= 1
\end{aligned} $$ Now as $\sum_{i=1}^k 2^{-l_i} \leq 1$ it implies that the node depths of the tree $\mathcal{T}<em>{r-1}$
satisfies $\sum</em>{i=1}^{r-1} 2^{-l_i} &lt; 1$ (for $r &lt;= k$)</li>
<li>We know from the Kraft inequality that if the inequality is not tight, then there will be a leaf node available at $\max_{i=1}^{r-1}
l_i = l_{r-1}$ depth. Now, as $l_r \geq l_{r-1}$, we can safely say that the node $n_k$ can be added to the binary
tree $\mathcal{T}_{r-1}$.</li>
<li>This completes the <em>correctness</em> proof.</li>
</ul>
<p>In fact if you look at the proof, all we have used is the fact that $\sum_{i=1}^k 2^{-l_i} \leq 1$. Thus, the same proof
also gives us the following <em>converse theorem</em> of the Kraft inequality:</p>
<div id="admonition-theorem-2-converse-of-kraft-inequality" class="admonition admonish-example" role="note" aria-labelledby="admonition-theorem-2-converse-of-kraft-inequality-title">
<div class="admonition-title">
<div id="admonition-theorem-2-converse-of-kraft-inequality-title">
<p>Theorem-2: Converse of Kraft Inequality</p>
</div>
<a class="admonition-anchor-link" href="#admonition-theorem-2-converse-of-kraft-inequality"></a>
</div>
<div>
<p>Let $l_i \in \mathbb{N}$ such that:
$$ \sum_{i=1}^k 2^{-l_i} \leq 1$$</p>
<p>then, we can always construct a binary tree with $k$ leaf nodes at depths $l_i$ from the root node for $i \in {1,\dots, k}$.</p>
</div>
</div>
<h2 id="kraft-inequality-and-the-thumb-rule"><a class="header" href="#kraft-inequality-and-the-thumb-rule">Kraft inequality and the thumb rule</a></h2>
<p>In the last chapter we introduced the thumb rule $l_{optimal}(symbol) \approx \log_2 \frac{1}{p(symbol)}$ without any justification. Since then
we have seen a code construction that gets close to this thumb rule. Here we briefly sketch how Kraft inequality can be shown to justify the thumb rule. Details can be found in section 5.3 of extremely popular book by Cover and Thomas "<a href="https://searchworks.stanford.edu/?search_field=search&amp;q=elements+of+information+theory">Elements of Information Theory</a>". The idea is to consider the optimization problem
$$
\min \sum_{i=1}^k p_i l_i \
\mathrm{subject\  to}  \sum_{i=1}^k 2^{-l_i} \leq 1
$$
This is simply the optimization problem to minimize the expected code lengths for a prefix code (Kraft's inequality gives a mathematical way to express the constraint). While this is a integer optimization problem (due to the code lengths being integral) and hence is hard to solve, we can relax the integer constraint and try to solve this for any positive $l_i$. Then the method of Lagrange multipliers from convex optimization can be used to sovle this problem and obtain the optimal code lengths $l_i = - \log p_i$. In the next chapter, we will look again into this and derive the thumb rule in a different way (though the Kraft inequality still plays a crucial role).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../lossless_iid/prefix_free_codes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../lossless_iid/entropy.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../lossless_iid/prefix_free_codes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../lossless_iid/entropy.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../mermaid.min.js"></script>
        <script type="text/javascript" src="../mermaid-init.js"></script>


    </body>
</html>
